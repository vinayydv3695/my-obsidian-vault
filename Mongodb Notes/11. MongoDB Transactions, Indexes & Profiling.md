


# # **1. Multi-Document Transactions (ACID)**

MongoDB supports **multi-document ACID transactions**, similar to relational databases.

### **Key Features**

- Atomic across:
    
    - Multiple documents
        
    - Multiple collections
        
    - Multiple databases
        
    - Sharded clusters (MongoDB 4.2+)
        
- If any operation fails → **the entire transaction is rolled back**.
    
- Guarantees:
    
    - **Atomicity**
        
    - **Consistency**
        
    - **Isolation**
        
    - **Durability**
        

### **Typical Use Cases**

- Financial operations (bank transfers)
    
- Multi-step workflows
    
- Maintaining consistency across related collections
    
- Avoiding partial updates
    

### **Important Notes**

- Single-document writes are already atomic; avoid unnecessary transactions.
    
- Transactions add overhead → use **only when needed**.
    
- Uncommitted writes stay only on the **primary node** until commit.
    

---

# ---------------------------------------------------------

# # **2. Indexing in MongoDB — Concepts & Types**

Indexes improve **read/query performance** by avoiding full collection scans.

### **Automatic Index**

- Every collection has a **unique `_id` index`**.
    

### **Index Types**

1. **Single Field Index**
    
2. **Compound Index** (multiple fields)
    
3. **Multikey Index** (arrays)
    
4. **Text Index** (full-text search)
    
5. **Hashed Index** (sharding support)
    
6. **Geospatial Index** (location queries)
    

---

# ---------------------------------------------------------

# # **3. Index Properties**

### **Unique Index**

Ensures no duplicate values.

### **Sparse Index**

- Skips documents that **do not contain** the field.
    
- Useful when many documents don’t have that field.
    

### **TTL Index (Time To Live)**

Automatically deletes documents after expiration.

Example:

```
db.logs.createIndex({ createdAt: 1 }, { expireAfterSeconds: 3600 })
```

### **Hidden Index**

- Query planner cannot see it.
    
- Useful for **testing index removal safely**.
    

---

# ---------------------------------------------------------

# # **4. Database Profiler (system.profile)**

Profiler collects detailed info about operations.

### **What It Records**

- CRUD operations
    
- Slow queries
    
- Execution stats
    
- Query shapes
    

### **Profiler Levels**

|Level|Meaning|
|---|---|
|**0**|Off (default)|
|**1**|Logs operations slower than threshold (`slowms`)|
|**2**|Logs **every** operation|

### **Key Commands**

Check current profiling status:

```
db.getProfilingStatus()
```

Enable profiling for slow queries:

```
db.setProfilingLevel(1, { slowms: 20 })
```

Data stored in:

- **`system.profile`** (capped 1 MB)
    

### **Caution**

Profiler adds overhead because it writes logs.

---

# ---------------------------------------------------------

# # **5. FTDC — Full Time Diagnostic Data Capture**

- Collects deep diagnostic data for **MongoDB support engineers**.
    
- Not accessible to regular users.
    
- Captures:
    
    - CPU, memory
        
    - DB stats
        
    - Command metadata
        
- Useful for debugging production incidents.
    

---

# ---------------------------------------------------------

# # **6. Summary**

- Transactions → ACID, multi-document, multi-collection atomicity.
    
- Indexes → major performance booster; choose correct type.
    
- Index properties (TTL, sparse, unique, hidden) enhance control.
    
- Profiler → understand slow queries; avoid leaving on level 2.
    
- FTDC → advanced diagnostics for support.
    


# ⭐ **20 MCQs

---

### **1. Multi-document transactions provide:**

A) Partial updates  
B) Atomic operations across multiple documents  
C) Faster indexing  
D) Schema validation  
**Answer: B**

---

### **2. MongoDB added multi-document transactions for sharded clusters in:**

A) 3.6  
B) 4.0  
C) 4.2  
D) 5.0  
**Answer: C**

---

### **3. Single-document writes in MongoDB are:**

A) Sometimes atomic  
B) Never atomic  
C) Always atomic  
D) Atomic only in sharded clusters  
**Answer: C**

---

### **4. Transactions should be used:**

A) For every write  
B) Rarely and only when needed  
C) For read-heavy workloads  
D) Only for indexing  
**Answer: B**

---

### **5. The default index created on every collection is:**

A) name index  
B) date index  
C) _id index  
D) hash index  
**Answer: C**

---

### **6. A sparse index:**

A) Speeds up writes  
B) Includes only docs containing the indexed field  
C) Removes duplicates  
D) Is required for sharding  
**Answer: B**

---

### **7. A TTL index is used to:**

A) Hide documents  
B) Delete expired documents automatically  
C) Sort documents by time  
D) Remove indexes after timeout  
**Answer: B**

---

### **8. A hidden index is:**

A) Used for sharding keys  
B) Ignored by query planner  
C) Required for replication  
D) Automatically deleted  
**Answer: B**

---

### **9. system.profile stores:**

A) Index definitions  
B) Profiler logs  
C) Backup metadata  
D) Shard configuration  
**Answer: B**

---

### **10. Profiling level 2 logs:**

A) Only slow queries  
B) Only failed commands  
C) All operations  
D) Only writes  
**Answer: C**

---

### **11. Which command checks profiling level?**

A) db.profileStatus()  
B) db.getProfiler()  
C) db.getProfilingStatus()  
D) db.status()  
**Answer: C**

---

### **12. Increasing profiler level may:**

A) Improve performance  
B) Add overhead due to logging  
C) Disable transactions  
D) Increase storage compression  
**Answer: B**

---

### **13. Hashed indexes are used for:**

A) Sorting  
B) Full-text search  
C) Hash-based sharding  
D) Wildcard pattern matching  
**Answer: C**

---

### **14. A multikey index supports:**

A) Subdocuments  
B) Arrays  
C) Binary data  
D) TTL expiration  
**Answer: B**

---

### **15. Text indexes are used for:**

A) Regex  
B) Full-text search  
C) Geospatial queries  
D) Metadata storage  
**Answer: B**

---

### **16. Geospatial indexes support queries like:**

A) find near a location  
B) nearest timestamp  
C) max string length  
D) compression ratio  
**Answer: A**

---

### **17. Profiler logs are capped at:**

A) 1 MB (default)  
B) 10 MB  
C) 100 MB  
D) Unlimited  
**Answer: A**

---

### **18. FTDC is primarily used by:**

A) Developers  
B) DBAs  
C) MongoDB Support Engineers  
D) End users  
**Answer: C**

---

### **19. Uncommitted transactional writes are stored on:**

A) Any node  
B) Only secondary nodes  
C) Only primary node  
D) Arbitrary cluster node  
**Answer: C**

---

### **20. Indexes help by:**

A) Making writes faster  
B) Avoiding collection scans for queries  
C) Reducing document size  
D) Storing backup snapshots  
**Answer: B**

---

