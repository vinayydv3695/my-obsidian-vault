
---

# ---------------------------------------------------------

# # ⭐ **1. MongoDB Security Overview**

MongoDB provides **multi-layered security**, including:

- **Authentication** (Who are you?)
    
- **Authorization** (What can you do?)
    
- **Encryption** (TLS + at-rest encryption)
    
- **Audit Logging**
    
- **Network security & access control**
    
- **Schema enforcement for CRUD safety**
    

These layers protect data from unauthorized access, tampering, and breaches.

---

# ---------------------------------------------------------

# # ⭐ **2. User Management (RBAC)**

MongoDB uses **Role-Based Access Control (RBAC)**.

### **Create an Admin User**

```js
db.createUser({
  user: "admin",
  pwd: passwordPrompt(),
  roles: [
    { role: "userAdminAnyDatabase", db: "admin" },
    { role: "readWriteAnyDatabase", db: "admin" }
  ]
})
```

### **Enable Authorization in config**

```
security:
  authorization: enabled
```

Enforces authentication + permissions for all operations.

### **Create Normal User**

```js
db.createUser({
  user: "test",
  pwd: passwordPrompt(),
  roles: [
    { role: "readWrite", db: "test" },
    { role: "read", db: "reporting" }
  ]
})
```

### RBAC Controls:

- CRUD access
    
- Schema modification
    
- Server operations
    
- Database administration
    

---

# ---------------------------------------------------------

# # ⭐ **3. Authentication & Authorization**

### **Authentication Mechanisms**

- **SCRAM** (default)
    
- **LDAP**
    
- **x.509 Certificates**
    
- **Kerberos**
    

### **Authorization**

- Once authenticated → user’s **roles** decide allowed actions.
    

Examples:

- `read`
    
- `readWrite`
    
- `dbAdmin`
    
- `clusterAdmin`
    

---

# ---------------------------------------------------------

# # ⭐ **4. Encryption in MongoDB**

MongoDB supports 2 major layers:

### **A. Data in Transit (TLS/SSL)**

Encrypts communication between:

- Client ↔ Server
    
- Server ↔ Server (replica sets, sharded clusters)
    

Prevents:

- Snooping
    
- MITM attacks
    
- Credential leakage
    

### **B. Data at Rest (Encryption on Disk)**

Protects stored data even if someone steals the disk.

Options:

- MongoDB Enterprise **Encrypted Storage Engine (WiredTiger)**
    
- OS-level disk encryption (LUKS, Windows EFS)
    
- Key management via **KMIP or AWS KMS**
    
- Uses **AES-256** encryption
    

---

# ---------------------------------------------------------

# # ⭐ **5. Client-Side Field Level Encryption (FLE)**

- Encryption happens **before** data leaves client.
    
- Server stores **only ciphertext**.
    
- Decryption only on the client.
    

Use cases:

- Credit cards
    
- SSN / Aadhaar
    
- Medical records
    

Works even for untrusted servers.

---

# ---------------------------------------------------------

# # ⭐ **6. Audit Logging**

Audit logs record **who did what and when**.

### Logs include:

- Auth attempts
    
- User creation / deletion
    
- CRUD operations
    
- Schema changes
    
- Replica / sharded config changes
    

### Target outputs:

- Console
    
- Syslog
    
- JSON file
    
- BSON file
    

Requirements:

- **Total order of logs**
    
- **Journaling enabled** before audit writes
    

Used for compliance:  
HIPAA, GDPR, PCI DSS, FERPA, FIPS-140-2.

---

# ---------------------------------------------------------

# # ⭐ **7. Network Security**

### **Default Bind**

MongoDB binds to **localhost only** for safety.

To allow external access:

```
net:
  bindIp: 127.0.0.1,192.168.1.10
```

### Best Practices

- Restrict connections to specific IPs/subnets
    
- Use firewalls, VPC, VPN
    
- Enable authentication everywhere
    
- Use TLS/SSL for node-to-node
    
- Disable unused ports
    

---

# ---------------------------------------------------------

# # ⭐ **8. Schema Security & CRUD Controls**

Use:

- **Schema validation rules** to restrict field structure
    
- **Roles** to limit CRUD operations
    
- Restrict:
    
    - DDL (index/collection changes)
        
    - Administrative operations
        

---

# ---------------------------------------------------------

# # ⭐ **9. Replication & Sharding Security**

Replica sets & sharded clusters require **internal node authentication**.

They use:

- **Keyfiles** shared across all nodes
    
- TLS certificates for encrypted intra-cluster communication
    

Ensures nodes trust each other.

---

# ---------------------------------------------------------

# # ⭐ **10. Summary of Best Practices**

- Always **enable authorization**
    
- Use **TLS** for all connections
    
- Encrypt data at rest (AES-256)
    
- Enable **audit logging**
    
- Restrict network access
    
- Apply **principle of least privilege**
    
- Use schema validation to protect data integrity
    

---

# ---------------------------------------------------------

# # ⭐ **20 MCQs 

---

### **1. MongoDB’s security model is primarily based on:**

A) Stored procedures  
B) Role-Based Access Control (RBAC)  
C) File permissions only  
D) Automatic hashing  
**Answer: B**

---

### **2. Enabling authorization is done in:**

A) mongosh  
B) mongod.cfg  
C) BIOS  
D) admin.js  
**Answer: B**

---

### **3. Authentication verifies:**

A) What user can do  
B) Who the user is  
C) The speed of queries  
D) Disk usage  
**Answer: B**

---

### **4. Which authentication mechanism is default?**

A) LDAP  
B) Kerberos  
C) SCRAM  
D) x.509  
**Answer: C**

---

### **5. Field-level encryption happens:**

A) On the server  
B) Inside WiredTiger  
C) On the client side  
D) During backup  
**Answer: C**

---

### **6. TLS is used for:**

A) Encrypting data in transit  
B) Encrypting data at rest  
C) Indexing  
D) Schema validation  
**Answer: A**

---

### **7. Data-at-rest encryption in MongoDB Enterprise uses:**

A) Base64  
B) XOR  
C) AES-256  
D) SHA-1  
**Answer: C**

---

### **8. Audit logs record:**

A) Only failed login attempts  
B) Only CRUD  
C) User actions, schema changes, authentication  
D) CPU usage only  
**Answer: C**

---

### **9. Audit logs require:**

A) Sharding enabled  
B) Schema validation  
C) Journaling enabled  
D) TTL indexes  
**Answer: C**

---

### **10. User creation uses:**

A) addUser()  
B) createAccount()  
C) db.createUser()  
D) addRole()  
**Answer: C**

---

### **11. By default, MongoDB binds to:**

A) 0.0.0.0  
B) localhost  
C) All network interfaces  
D) Private subnets only  
**Answer: B**

---

### **12. To allow external access, we modify:**

A) replication section  
B) security section  
C) net.bindIp  
D) wireTiger section  
**Answer: C**

---

### **13. Which is required for replica set internal authentication?**

A) Username/password  
B) ACL files  
C) Keyfiles  
D) JSON schema  
**Answer: C**

---

### **14. Client-side field-level encryption ensures:**

A) Server can decrypt data  
B) Server stores plaintext  
C) Only the client sees decrypted fields  
D) Query planner improves  
**Answer: C**

---

### **15. Example of a compliance standard supported:**

A) FIFA  
B) PCI DSS  
C) W3C  
D) NPM  
**Answer: B**

---

### **16. TLS protects against:**

A) Slow queries  
B) Missing indexes  
C) Man-in-the-middle attacks  
D) Data modeling errors  
**Answer: C**

---

### **17. Role giving read/write access to one DB:**

A) clusterAdmin  
B) readWrite  
C) userAdminAnyDatabase  
D) dbOwner  
**Answer: B**

---

### **18. Schema validation helps:**

A) Improve sharding  
B) Restrict allowed data formats  
C) Backup the database  
D) Reduce replica lag  
**Answer: B**

---

### **19. What should be placed behind VPN / private networks?**

A) Mongosh  
B) Mongod servers  
C) Client apps  
D) Logs  
**Answer: B**

---

### **20. Best practice for MongoDB security includes:**

A) Disable authorization  
B) Use plaintext transmission  
C) Enable TLS + RBAC + audit logging  
D) Allow all IPs  
**Answer: C**

---

